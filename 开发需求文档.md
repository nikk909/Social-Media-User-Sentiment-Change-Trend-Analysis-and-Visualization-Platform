# 社交媒体用户情绪变化趋势分析与可视化平台 —— 开发需求文档

## 1. 项目概述与目标
- 目标：构建一个轻量化平台，对社交媒体文本进行采集、清洗、情感分类，并按时间窗口聚合，提供交互式可视化，帮助市场营销、政策制定、心理健康研究等场景洞察“情绪随时间的变化趋势”。
- 价值：从“静态单点”转为“动态时序”，量化正/负/中性情绪比例变化，并识别各时段热点话题。

## 2. 范围与不做事项
- 范围：
  - 单话题/事件的历史数据分析（初期非实时）。
  - 固定时间窗口聚合（如按小时/天）。
  - 交互式可视化（折线图、词云、简单热力图 可选）。
- 暂不包含：
  - 大规模分布式采集与高并发实时流处理。
  - 多话题并行对比与跨平台统一用户画像。

## 3. 功能模块与详细需求
### 3.1 数据采集模块
- 输入：话题/关键词、时间范围、平台（微博/Twitter 等）。
- 功能：
  - 爬取文本与发布时间；保留来源平台。
  - 支持按时间范围筛选。
  - 失败重试与最小限度反爬策略（限速、随机 UA）。
- 输出字段：`raw_text`, `post_time`, `platform`。
- 技术建议：Requests + BeautifulSoup 或精简 Scrapy；统一写入 CSV/JSONL。

### 3.2 文本预处理模块
- 功能：
  - 去除 URL、@、# 话题标记、特殊符号；表情符号标准化。
  - 去重（文本 hash 或近似重复判定阈值）。
  - 语言/编码清洗（必要时统一为 UTF-8）。
- 输出字段：`cleaned_text`, `timestamp`（由 `post_time` 规整）。

### 3.3 情感分类模块
- 目标：对 `cleaned_text` 进行情感判定（pos/neg/neu）。
- 技术选型：
  - 入门：TextBlob 或 VADER（社媒友好，CPU 可用）。
  - 可选：轻量化 BERT（如 ALBERT）以提升精度（作为可插拔后续能力）。
- 输出字段新增：`sentiment ∈ {pos, neg, neu}`，可附带 `score`（可选）。
- 质量要求：
  - 基线准确率：≥ 0.65（公开样本或小规模标注集上评估）。
  - 可配置阈值以调节中性/正负划分敏感度。

### 3.4 时间序列分析模块
- 功能：
  - 以固定窗口（小时/天）`resample` 聚合。
  - 计算各窗口内 pos/neg/neu 占比与计数。
  - 结合 TF-IDF 提取窗口内高频词/关键词。
- 输出字段：`window_start`, `window_end`, `pos_ratio`, `neg_ratio`, `neu_ratio`, `hot_words`（前 K 个）。
- 技术：Pandas（分组聚合）、scikit-learn（TF-IDF）。

### 3.5 可视化模块
- 交互式图表：
  - 折线图：时间 x 轴，y 轴为情绪占比（pos/neg/neu）。
  - 词云图：按情绪或时间窗口展示高频词。
  - 简单热力图（可选）：不同话题/窗口的情绪强度分布。
- 交互需求：
  - 选择话题/时间范围过滤。
  - 悬浮提示（窗口指标/示例词）。
  - 导出图表为 PNG/HTML（可选）。
- 技术：Plotly + Streamlit（快速搭建 Web 界面）。

## 4. 数据流程
原始数据 → 预处理清洗 → 情感分类 → 按时间窗口聚合/关键词提取 → 可视化展示

## 5. 数据模型与存储
- 原始数据表（CSV/JSONL）：`raw_text`, `post_time`, `platform`。
- 清洗后数据表：`cleaned_text`, `timestamp`, `platform`。
- 情感结果表：在清洗表基础上新增 `sentiment`, `score`（可选）。
- 时序聚合表：`window_start`, `window_end`, `pos_cnt`, `neg_cnt`, `neu_cnt`, `pos_ratio`, `neg_ratio`, `neu_ratio`, `hot_words`。

## 6. 界面与交互（示意）
- 侧边栏：话题输入、平台选择、时间范围、窗口粒度。
- 主区：
  - 趋势折线图（pos/neg/neu）。
  - 当前窗口词云（可切换情绪或时间片）。
  - 热力图（可选）。

## 7. 非功能性需求
- 性能：
  - 10 万条文本以内单机可在 10 分钟级完成全流程（参考）。
  - 可视化交互延迟 < 300ms（常见筛选/缩放）。
- 可用性：
  - 初学者 15 分钟内按文档可跑通。
  - 错误提示清晰（缺数据、时间无效、网络失败等）。
- 兼容性：CPU 运行；Windows/macOS/Linux。

## 8. 技术栈
- 采集：Requests + BeautifulSoup / 简化 Scrapy。
- 处理：Pandas。
- 情感：TextBlob / VADER（可插拔 ALBERT）。
- 特征：scikit-learn（TF-IDF）。
- 可视化：Plotly + Streamlit。

## 9. 简要架构
- Ingest 层：采集器（平台适配、重试、写文件）。
- Processing 层：预处理、情感分类、聚合与 TF-IDF。
- Presentation 层：Streamlit 前端（Plotly 图表）。

## 10. 接口与运行方式
- 批处理 CLI（示例）：
  - `ingest --platform twitter --query "<topic>" --start 2024-01-01 --end 2024-01-31 --out data/raw.jsonl`
  - `preprocess --in data/raw.jsonl --out data/clean.jsonl`
  - `sentiment --in data/clean.jsonl --out data/sent.jsonl --backend vader`
  - `agg --in data/sent.jsonl --window 1D --out data/agg.csv`
  - `app`（启动 Streamlit 并加载 `data/agg.csv`）

## 11. 验收标准
- 核心用例：
  - 输入话题与时间范围，完成采集与分析，展示趋势与词云。
  - 可切换窗口粒度并更新图表。
- 质量门槛：
  - 情感分类达到基线准确率。
  - 可视化交互符合需求且无明显卡顿。

## 12. 里程碑与计划
- M1 原型：本地 CSV 输入 → 预处理 → VADER → 聚合 → 静态图。
- M2 交互：Streamlit 界面、折线+词云、筛选控件。
- M3 采集：接入 1 个平台采集器，端到端跑通。
- M4 加强：TF-IDF 热词、导出、轻量 BERT 可插拔。

## 13. 风险与合规
- 法律与合规：遵守平台条款与当地数据法规；仅采集公开数据；必要时脱敏与匿名化。
- 模型偏差：情感词典失配导致误判，提供阈值/多模型备选与抽样人工校验。
- 反爬限制：限速与失败退避，必要时人工导入历史数据。

## 14. 部署与运维（基础）
- 运行环境：Python 3.9+，pip/venv。
- 监控与日志：
  - 采集与分析阶段产生结构化日志（INFO/WARN/ERROR）。
  - 关键指标：采集成功率、去重率、情感分布稳定性、可视化加载时延。


